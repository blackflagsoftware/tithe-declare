import{d as H,r as b,J as T,x as h,z as e,A as _,M as A,N as B,y as p,P as N,k as D,o as K,B as L,K as j,L as J,O as q,V as G}from"./_J1N5LE9.js";import{b as P,a as Q}from"./e8YS3tKj.js";import{a as W}from"./D3r0DRHi.js";import{m as $}from"./Cki1o9vr.js";const X={class:"fixed inset-0 transition-opacity bg-gray-50 bg-opacity-75"},Y={tabindex:"-1",class:"fixed z-50 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-auto bg-white dark:bg-gray-900 rounded-md px-4 py-2 space-y-5 drop-shadow-lg"},Z={class:"relative p-4 w-full max-w-2xl max-h-full"},ee={class:"relative bg-white dark:bg-gray-900 rounded-lg shadow dark:bg-black"},te={class:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:bg-gray-900 dark:border-gray-600"},oe={class:"text-xl font-semibold text-gray-900 dark:text-white"},re={class:"p-4 md:p-5 space-y-8 dark:bg-gray-900"},ae={class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},le={class:"list-none pl-0 mt-0"},se=["id","value","checked","onChange"],ne=["htmlFor"],de={class:"flex items-center p-4 md:p-5 border-t border-gray-200 rounded-b dark:border-gray-600 dark:bg-gray-900"},ue=H({__name:"register-route-modal",props:{titleText:{},registerRoute:{},roles:{}},emits:["clickSubmit","clickCancel"],setup(S,{emit:k}){const u=k,i=S,n=b("Register Route"),c=b(""),C=b(new Array),l=b(new Array);function f(){const t={raw_path:c.value,roles_selected:l.value};u("clickSubmit",t),g()}function v(){g(),u("clickCancel")}function y(t){l.value=l.value.map((o,s)=>t===s?!o:o)}function g(){c.value="",C.value=[],l.value=[]}return T(()=>i.registerRoute,t=>{t&&(c.value=t.raw_path,C.value=t.roles,l.value=t.roles_selected)},{immediate:!0}),T(()=>i.titleText,t=>{n.value=t},{immediate:!0}),(t,o)=>(p(),h("div",X,[e("div",Y,[e("div",Z,[e("div",ee,[e("div",te,[e("p",oe,_(n.value),1),e("button",{type:"button",class:"text-gray-400 bg-transparent hover:bg-gray-50 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white",onClick:o[0]||(o[0]=s=>v())},[...o[3]||(o[3]=[e("svg",{class:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14"},[e("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})],-1),e("span",{class:"sr-only"},"Close modal",-1)])])]),e("div",re,[e("div",null,[e("label",ae,_(c.value),1),o[4]||(o[4]=e("p",{class:"text-base mt-4 mb-2"},"Roles",-1)),e("ul",le,[(p(!0),h(A,null,B(i.roles,(s,R)=>(p(),h("div",null,[(p(),h("li",{key:R},[e("input",{id:s.id.toString(),type:"checkbox",value:s.name,checked:l.value[R],class:"mr-2",onChange:E=>y(R)},null,40,se),e("label",{htmlFor:s.id},_(s.name),9,ne)]))]))),256))])])]),e("div",de,[e("button",{onClick:o[1]||(o[1]=s=>f()),type:"button",class:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"},"Submit"),e("button",{onClick:o[2]||(o[2]=s=>v()),type:"button",class:"py-2.5 px-5 ms-3 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-100 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700"},"Cancel")])])])])]))}}),ie={class:"fixed inset-0 transition-opacity bg-gray-50 bg-opacity-75"},ce={tabindex:"-1",class:"fixed z-50 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-auto bg-white dark:bg-gray-900 rounded-md px-4 py-2 space-y-5 drop-shadow-lg"},ge={class:"relative p-4 w-full max-w-2xl max-h-full"},be={class:"relative bg-white dark:bg-gray-900 rounded-lg shadow dark:bg-black"},me={class:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:bg-gray-900 dark:border-gray-600"},he={class:"p-4 md:p-5 space-y-8 dark:bg-gray-900"},pe={class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},ve={class:"list-none pl-0 mt-0"},ke=["id","value","checked","onChange"],fe=["htmlFor"],ye={class:"list-none pl-0 mt-0"},xe=["id","value","checked","onChange"],we=["htmlFor"],_e={class:"flex items-center p-4 md:p-5 border-t border-gray-200 rounded-b dark:border-gray-600 dark:bg-gray-900"},Ce=H({__name:"register-route-bulk-modal",props:{rawPathCount:{},roles:{}},emits:["clickSubmit","clickCancel"],setup(S,{emit:k}){const u=k,i=S,n=b(new Array),c=b(new Array);function C(){const g={add_roles:n.value,remove_roles:c.value};y(),u("clickSubmit",g)}function l(){y(),u("clickCancel")}function f(g){n.value=n.value.map((t,o)=>g===o?!t:t),n.value[g]&&(c.value[g]=!1)}function v(g){c.value=c.value.map((t,o)=>g===o?!t:t),c.value[g]&&(n.value[g]=!1)}function y(){n.value=[],c.value=[]}return T(()=>i.rawPathCount,g=>{n.value=new Array(i.roles.length).fill(!1),c.value=new Array(i.roles.length).fill(!1)},{immediate:!0}),(g,t)=>(p(),h("div",ie,[e("div",ce,[e("div",ge,[e("div",be,[e("div",me,[t[4]||(t[4]=e("p",{class:"text-xl font-semibold text-gray-900 dark:text-white"},"Bulk Add/Remove Roles",-1)),e("button",{type:"button",class:"text-gray-400 bg-transparent hover:bg-gray-50 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white",onClick:t[0]||(t[0]=o=>l())},[...t[3]||(t[3]=[e("svg",{class:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14"},[e("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})],-1),e("span",{class:"sr-only"},"Close modal",-1)])])]),e("div",he,[e("div",null,[e("label",pe,"Apply changes for ("+_(i.rawPathCount)+") paths",1),t[5]||(t[5]=e("p",{class:"text-base mt-4 mb-2"},"Add Roles",-1)),e("ul",ve,[(p(!0),h(A,null,B(i.roles,(o,s)=>(p(),h("div",null,[(p(),h("li",{key:s},[e("input",{id:o.id.toString(),type:"checkbox",value:o.name,checked:n.value[s],class:"mr-2",onChange:R=>f(s)},null,40,ke),e("label",{htmlFor:o.id},_(o.name),9,fe)]))]))),256))]),t[6]||(t[6]=e("p",{class:"text-base mt-4 mb-2"},"Remove Roles",-1)),e("ul",ye,[(p(!0),h(A,null,B(i.roles,(o,s)=>(p(),h("div",null,[(p(),h("li",{key:s},[e("input",{id:o.id.toString(),type:"checkbox",value:o.name,checked:c.value[s],class:"mr-2",onChange:R=>v(s)},null,40,xe),e("label",{htmlFor:o.id},_(o.name),9,we)]))]))),256))])])]),e("div",_e,[e("button",{onClick:t[1]||(t[1]=o=>C()),type:"button",class:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"},"Submit"),e("button",{onClick:t[2]||(t[2]=o=>l()),type:"button",class:"py-2.5 px-5 ms-3 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-100 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700"},"Cancel")])])])])]))}}),Re={class:"flex flex-column mb-4"},$e=["disabled"],Ae={class:"relative overflow-x-auto shadow-md sm:rounded-lg"},Se={class:"w-full text-sm text-left rtl:text-right text-gray-600 dark:text-gray-400"},Te={class:"text-xs text-gray-700 uppercase bg-gray-400 dark:bg-gray-600 dark:text-gray-200"},Be={class:"px-6 py-3"},Me={class:"odd:bg-white odd:dark:bg-gray-900 even:bg-gray-200 even:dark:bg-gray-800 border-b dark:border-gray-700"},Pe={class:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white"},He=["value"],Ee={scope:"row",class:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white"},Fe={class:"px-6 py-4"},Le={class:"px-6 py-4"},je=["onClick"],Ve=H({__name:"register_routes",setup(S){const k=b(new Array),u=b(new Array),i=b(P(u.value));b(Q());const n=b(""),c=b(!1),C=b(!0),l=b([]);b(P(u.value));const{getAuthHeader:f}=N(),v=W();function y(){v("/register-route/search",{method:"POST",headers:f()}).then(a=>{k.value=a.data.data})}function g(){v("/role/search",{method:"POST",body:{},headers:f()}).then(a=>{u.value=a.data.data})}function t(a){i.value=k.value?.find(r=>r.raw_path===a),i.value.roles_selected=R(i.value.roles),C.value=!1,$(!0,"register-route-modal")}function o(a){const r=u.value.reduce((x,m,w)=>(a.roles_selected[w]&&x.push(m.name),x),[]),d={...a,roles:r};v("/register-route",{method:"PATCH",body:d,headers:f()}),y(),$(!1,"register-route-modal")}function s(){i.value=P(u.value),$(!1,"register-route-modal")}function R(a){return u.value.map(r=>a.includes(r))}function E(a,r){let d;return(...x)=>{clearTimeout(d),d&&clearTimeout(d),d=setTimeout(()=>a(...x),r)}}const F=async()=>{if(n.value.length<2){y(),l.value=[];const a=document.getElementById("bulkCheckboxHeader");a instanceof HTMLInputElement?a.checked=!1:console.error("The element 'bulkCheckboxHeader' is not a valid input element.");return}c.value=!0;try{const a={search:{filters:[{column:"raw_path",compare:"LIKE",value:n.value}]}},r=await v("/register-route/search",{method:"POST",body:a,headers:f()});k.value=r.data.data,l.value=[];const d=document.getElementById("bulkCheckboxHeader");d instanceof HTMLInputElement?d.checked=!1:console.error("The element 'bulkCheckboxHeader' is not a valid input element.")}catch(a){console.error("Error searching register routes:",a)}finally{c.value=!1}};function I(){$(!0,"register-route-bulk-modal")}function U(a){const r=u.value.reduce((m,w,M)=>(a.add_roles[M]&&m.push(w.name),m),[]),d=u.value.reduce((m,w,M)=>(a.remove_roles[M]&&m.push(w.name),m),[]),x={raw_paths:l.value,add_roles:r,remove_roles:d};v("/register-route/bulk",{method:"POST",body:x,headers:f()}).then(()=>{F(),l.value=[]}),$(!1,"register-route-bulk-modal")}function z(){$(!1,"register-route-bulk-modal")}function O(a){a.target.checked?k.value.forEach(d=>{l.value.includes(d.raw_path)||l.value.push(d.raw_path)}):l.value=[]}T(n,E(F,500));const V=D(()=>l.value.length===0);return K(()=>{y(),g()}),(a,r)=>{const d=ue,x=Ce;return p(),h(A,null,[r[5]||(r[5]=e("p",{class:"text-4xl"},"Admin",-1)),r[6]||(r[6]=e("p",{class:"mt-8 mb-2 text-2xl"},"Register Routes",-1)),e("div",Re,[j(e("input",{id:"register_route_search","onUpdate:modelValue":r[0]||(r[0]=m=>n.value=m),class:"bg-gray-200 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 w-96",placeholder:"Search..."},null,512),[[J,n.value]]),e("button",{id:"bulk-update",disabled:q(V),onClick:I,class:"ml-4 text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800 disabled:bg-gray-600 disabled:hover:bg-gray-500"},"Bulk Update",8,$e)]),r[7]||(r[7]=e("p",{class:"mt-4 mb-2 text-sm"},"No Roles are considered 'open' routes",-1)),e("div",Ae,[e("table",Se,[e("thead",Te,[e("tr",null,[e("th",Be,[e("input",{id:"bulkCheckboxHeader",type:"checkbox",class:"form-checkbox h-4 w-4 text-blue-600",onChange:O},null,32)]),r[2]||(r[2]=e("th",{scope:"col",class:"px-6 py-3"}," Raw Path ",-1)),r[3]||(r[3]=e("th",{scope:"col",class:"px-6 py-3"}," Roles ",-1)),r[4]||(r[4]=e("th",{scope:"col",class:"px-6 py-3"}," Action ",-1))])]),e("tbody",null,[(p(!0),h(A,null,B(k.value,m=>(p(),h("tr",Me,[e("th",Pe,[j(e("input",{type:"checkbox",class:"form-checkbox h-4 w-4 text-blue-600",value:m.raw_path,"onUpdate:modelValue":r[1]||(r[1]=w=>l.value=w)},null,8,He),[[G,l.value]])]),e("th",Ee,_(m.raw_path),1),e("td",Fe,_(m.roles),1),e("td",Le,[e("a",{href:"#",onClick:w=>t(m.raw_path),class:"font-medium text-blue-600 dark:text-blue-500 hover:underline"},"Edit",8,je)])]))),256))])])]),L(d,{id:"register-route-modal",class:"hidden",registerRoute:i.value,roles:u.value,onClickSubmit:o,onClickCancel:s,titleText:(C.value?"Add":"Edit")+" RegisterRoute"},null,8,["registerRoute","roles","titleText"]),L(x,{id:"register-route-bulk-modal",class:"hidden",rawPathCount:l.value.length,roles:u.value,onClickSubmit:U,onClickCancel:z},null,8,["rawPathCount","roles"])],64)}}});export{Ve as default};
